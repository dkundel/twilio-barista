webpackJsonp([2],{"4PFe":function(e){e.exports={card:"card__Ngf5f",radioContainer:"radioContainer__rQxYZ",messageInput:"messageInput__2rgCX"}},DrQb:function(e){e.exports={others:"others__1O6Ck",cardContainer:"cardContainer__3ETnG",flexOne:"flexOne__hvoth"}},OxQN:function(e){e.exports={configList:"configList__1KlK2",configEntry:"configEntry__3ylZx",jsonList:"jsonList__1GqC_",jsonSwitch:"jsonSwitch__2558N",jsonSpacer:"jsonSpacer__2-6vv",jsonHeadline:"jsonHeadline__1XwOz",createNewJsonEntryButtons:"createNewJsonEntryButtons__y3WpO",deleteButton:"deleteButton__1sQ6n"}},RS7i:function(e){e.exports={admin:"admin__PFOGc",tabsLeft:"tabsLeft__3gzD1"}},WJzZ:function(e){e.exports={eventSelector:"eventSelector__3BhRr",eventForm:"eventForm__2CF3t",eventFormNameInput:"eventFormNameInput__1aZxk"}},tUI8:function(e,t,n){"use strict";function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e){var t=e.title,n=e.children,o=e.buttonText,r=e.action,i=e.disabled;return Object(m.h)(C.Card,{shadow:"2"},Object(m.h)(C.Card.Title,null,Object(m.h)(C.Card.TitleText,null,t)),Object(m.h)(C.Card.Text,{class:Q.a.flexOne},n),Object(m.h)(C.Card.Actions,{class:"mdl-card--border"},Object(m.h)(C.Button,{raised:!0,accent:!0,onClick:r,disabled:i},o)))}function v(e){function t(e){o(e.target.value)}var n=e.countries,o=e.onSelect,r=e.value;return Object(m.h)("select",{class:"mdc-select",onChange:t},n.map(function(e){return Object(m.h)("option",{value:e.code,selected:r===e.code},e.country)}))}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var m=n("KM04"),C=(n("QJSD"),n("3PZ7")),j=n("E1Zn"),E=n("OxQN"),T=n.n(E),w=function(e){function t(){return o(this,e.apply(this,arguments))}return r(t,e),t.prototype.render=function(){var e=this,t=this.props.config,n=Object.keys(t).sort(function(n,o){return e.sortConfig(t,n,o)}).map(function(n){var o=t[n];return"boolean"==typeof o?e.createBooleanInput(n,o):Array.isArray(o)?e.createArrayInput(n,o):"object"==typeof o?e.createJsonInput(n,o):e.createTextInput(n,o)});return Object(m.h)("div",{class:T.a.configList},n)},t.prototype.createTextInput=function(e,t){var n=this;return Object(m.h)("div",{class:T.a.configEntry},Object(m.h)(C.TextField,{"floating-label":!0,label:e,type:"text",name:e,value:t,onChange:function(e){return n.handleInputChange(e)}}))},t.prototype.createBooleanInput=function(e,t){var n=this;return Object(m.h)("div",{class:T.a.configEntry},Object(m.h)(C.Switch,{type:"checkbox",name:e,checked:t,onChange:function(t){return n.handleInputChange(t,e)}},e))},t.prototype.createArrayInput=function(e,t){var n=this;return Object(m.h)("div",{class:T.a.configEntry},Object(m.h)(C.TextField,{"floating-label":!0,label:e,type:"text",name:e,value:t.join(", "),onChange:function(e){return n.handleArrayInputChange(e)}}))},t.prototype.createJsonInput=function(e,t){var n=this,o=Object.keys(t),r=typeof t[o[0]],i=o.map(function(o,r){var i=t[o],a="boolean"==typeof i?Object(m.h)(C.Switch,{class:T.a.jsonSwitch,checked:i,onChange:function(r){return n.handleJsonValueChange(e,t,o,r)}}):Object(m.h)(C.TextField,{class:T.a.jsonInput,placeholder:"value",value:i,onChange:function(r){return n.handleJsonValueChange(e,t,o,r)}});return Object(m.h)("div",{class:T.a.jsonEntry},Object(m.h)(C.Button,{class:T.a.deleteButton,colored:!0,accent:!0,onClick:function(){return n.deleteJsonEntry(e,t,o)}},"Ã—"),Object(m.h)(C.TextField,{class:T.a.jsonKey,placeholder:"key",value:o,onChange:function(o){return n.handleJsonKeyChange(e,t,r,o)}}),Object(m.h)("span",{class:T.a.jsonSpacer},":"),a)});return Object(m.h)("div",{class:T.a.configEntry},Object(m.h)("h6",{class:T.a.jsonHeadline},e),Object(m.h)("div",{class:T.a.jsonList},i),Object(m.h)("div",{class:T.a.createNewJsonEntryButtons},"boolean"!==r&&Object(m.h)(C.Button,{primary:!0,colored:!0,onClick:function(){return n.createNewJsonEntry(e,t)}},"Create Text Entry"),"boolean"===r&&Object(m.h)(C.Button,{primary:!0,colored:!0,onClick:function(){return n.createNewJsonEntry(e,t,!1)}},"Create Boolean Entry")))},t.prototype.handleInputChange=function(e,t){var n=e.target,o="checkbox"===n.type?n.checked:n.value;this.props.update(t||n.name,o)},t.prototype.handleArrayInputChange=function(e){var t=e.target,n=t.value,o=t.name;n=n.split(",").map(function(e){return e.trim()}).filter(function(e){return e.length>0}),this.props.update(o,n)},t.prototype.handleJsonKeyChange=function(e,t,n,o){var r=o.target.value,i=Object.keys(t)[n];t[r]=t[i],delete t[i],this.props.update(e,t)},t.prototype.handleJsonValueChange=function(e,t,n,o){t[n]="checkbox"===o.target.type?o.target.checked:o.target.value,this.props.update(e,t)},t.prototype.createNewJsonEntry=function(e,t,n){n=void 0===n?"CHOOSE_VALUE":n,t[j.DEFAULT_JSON_ENTRY_KEY]=n,this.props.update(e,t)},t.prototype.deleteJsonEntry=function(e,t,n){delete t[n],this.props.update(e,t)},t.prototype.sortConfig=function(e,t,n){var o=e[t],r=e[n],i=typeof o,a=typeof r;return i===a?t>n?1:t<n?-1:0:"boolean"===i?-1:"boolean"===a?1:"string"===i?-1:"string"===a?1:"number"===i?-1:"number"===a?1:"object"!==i||Array.isArray(o)?"object"!==a||Array.isArray(r)?t>n?1:t<n?-1:0:1:-1},t}(m.Component),S=n("WJzZ"),_=n.n(S),P=Object(m.h)("h5",null,"Create a new event"),A=Object(m.h)("p",null,"Pick a name for the event. This name might be shown to the attendees."),I=Object(m.h)(C.Button,{primary:!0,raised:!0,type:"submit"},"Create"),x=Object(m.h)("hr",null),k=function(e){function t(e){e.preventDefault();var t=e.target.eventName,o=t.value;t.value="",n(o)}var n=e.onNewEvent;return Object(m.h)("form",{onSubmit:t,class:_.a.eventForm},P,A,Object(m.h)(C.TextField,{"floating-label":!0,label:"Event Name",type:"text",name:"eventName",value:"",class:_.a.eventFormNameInput}),I,x)},N=Object(m.h)("label",{for:"eventPicker"},"Pick your event"),F=Object(m.h)("h5",null,"Other Actions"),R=Object(m.h)("h5",null,"Event Configuration"),D=Object(m.h)(C.Progress,{indeterminate:!0}),J=function(e){function t(){return i(this,t),a(this,e.apply(this,arguments))}return c(t,e),t.prototype.render=function(){var e=this.props,t=e.events,n=e.currentEventId,o=e.currentEventConfig,r=e.onEventChange,i=e.onResetEvent,a=e.onDeleteEvent,c=e.onCreateEvent,s=e.onUpdateEventConfig,u=e.onCancelOrders,l=t.map(function(e){return Object(m.h)("option",{selected:e===n},e)}),h=Object(m.h)("div",{class:_.a.eventSelector},N,Object(m.h)("select",{id:"eventPicker",class:"mdc-select",value:n,onChange:function(e){return r(e.target.value)}},l)),d=Object(m.h)("div",null,F,Object(m.h)(C.Button,{raised:!0,accent:!0,onClick:i},"Reset Stats"),Object(m.h)(C.Button,{accent:!0,onClick:a},"Delete Event"),Object(m.h)(C.Button,{accent:!0,onClick:u},"Cancel All Orders"));return Object(m.h)("div",null,Object(m.h)(k,{onNewEvent:c}),t.length>0&&h,R,o?Object(m.h)(w,{config:o,update:s}):D,o&&d)},t}(m.Component),B=n("4PFe"),L=n.n(B),M=Object(m.h)("h4",null,"Send a message"),G=Object(m.h)(C.Button,{raised:!0,primary:!0,type:"submit"},"Send Message"),q=Object(m.h)("span",{class:"mdl-chip"},Object(m.h)("span",{class:"mdl-chip__text"},"Your message has been sent!")),V=Object(m.h)("label",{for:"eventPicker"},"Pick your event"),Y=function(e){function t(){s(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var i=u(this,e.call.apply(e,[this].concat(o)));return i.state.sendTo="all",i.state.events=[],i}return l(t,e),t.prototype.componentWillMount=function(){return new Promise(function(e,t){var n,o;return Promise.resolve(fetch("/api/admin/events?type=full")).then(function(r){try{return Promise.resolve(r.json()).then(function(r){try{return n=r,o=n.events,this.setState({events:o}),e()}catch(e){return t(e)}}.bind(this),t)}catch(e){return t(e)}}.bind(this),t)}.bind(this))},t.prototype.sendMessage=function(e){var t=this;e.preventDefault();var n=e.target,o=n.sendTo,r=n.message,i=n.identity,a=n.selectedEvent,c={sendTo:o.value,message:r.value};-1!==o.value.indexOf("ForEvent")&&(console.log(a),c.eventId=a.value),i&&(c.identity=i.value),fetch("/api/admin/notification",{credentials:"include",headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(c)}).then(function(e){if(e.ok)return e.json();throw new Error("Failed request")}).then(function(){t.setState({sendTo:"all",message:void 0,identity:void 0,messageSent:!0}),setTimeout(function(){t.setState({messageSent:void 0})},5e3)}).catch(function(e){console.error(e)})},t.prototype.handleInputChange=function(e){var t;this.setState((t={},t[e.target.name]=e.target.value,t))},t.prototype.render=function(){var e=this;return Object(m.h)("div",null,M,Object(m.h)("form",{onSubmit:function(t){return e.sendMessage(t)}},Object(m.h)(C.Card,{class:L.a.card,shadow:"2"},Object(m.h)(C.Card.Text,null,Object(m.h)("div",{class:L.a.radioContainer},Object(m.h)(C.Radio,{name:"sendTo",value:"all",checked:"all"===this.state.sendTo,onChange:function(t){return e.handleInputChange(t)}},"All"),Object(m.h)(C.Radio,{name:"sendTo",value:"activeOrders",checked:"activeOrders"===this.state.sendTo,onChange:function(t){return e.handleInputChange(t)}},"All Active Orders"),Object(m.h)(C.Radio,{name:"sendTo",value:"allForEvent",checked:"allForEvent"===this.state.sendTo,onChange:function(t){return e.handleInputChange(t)}},"Everyone For Event"),Object(m.h)(C.Radio,{name:"sendTo",value:"activeOrdersForEvent",checked:"activeOrdersForEvent"===this.state.sendTo,onChange:function(t){return e.handleInputChange(t)}},"Active Orders For Event"),Object(m.h)(C.Radio,{name:"sendTo",value:"individual",checked:"individual"===this.state.sendTo,onChange:function(t){return e.handleInputChange(t)}},"Individual")),"individual"===this.state.sendTo&&Object(m.h)("div",null,Object(m.h)(C.TextField,{name:"identity","float-label":!0,value:this.state.identity,onChange:function(t){return e.handleInputChange(t)}},"Identity of individual...")),-1!==this.state.sendTo.indexOf("ForEvent")&&this.renderSelector(),Object(m.h)("div",null,Object(m.h)(C.TextField,{class:L.a.messageInput,multiline:!0,name:"message",onChange:function(t){return e.handleInputChange(t)},value:this.state.message},"Type your message..."))),Object(m.h)(C.Card.Actions,{class:"mdl-card--border"},G,this.state.messageSent&&q))))},t.prototype.renderSelector=function(){var e=this.state.events.map(function(e){return Object(m.h)("option",{value:e.eventId},e.eventName)});return Object(m.h)("div",{class:L.a.eventSelector},V,Object(m.h)("select",{id:"eventPicker",name:"selectedEvent",class:"mdc-select"},e))},t}(m.Component),K=n("DrQb"),Q=n.n(K),Z=Object(m.h)("h4",null,"Other Operations"),U=Object(m.h)("p",null,"Choose a country that you want a phone number to acquire for. Once acquired it will appear in the config under"," ",Object(m.h)("code",null,"connectedPhoneNumbers"),"."),z=Object(m.h)(C.Progress,{indeterminate:!0}),H=Object(m.h)("p",null,"This will clear out all open and past orders, reset the configuration to default, delete all Notify bindings and clear the customer map."),W=function(e){function t(){h(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var i=d(this,e.call.apply(e,[this].concat(o)));return i.state.availableCountries=void 0,i.state.selectedCountry=void 0,i.state.resetApplicationActivated=!1,i}return f(t,e),t.prototype.resetApplication=function(){fetch("/api/admin/reset?action=resetApplication",{method:"POST",credentials:"include"}).then(function(e){if(!e.ok)throw new Error(e.statusText);console.log("Reset application")}).catch(function(e){console.error(e)})},t.prototype.getAvailableCountries=function(){var e=this;fetch("/api/admin/numbers").then(function(e){if(e.ok)return e.json();throw new Error(e.statusText)}).then(function(t){e.setState({availableCountries:t.countries})}).catch(function(e){console.error(e)})},t.prototype.choseCountry=function(e){this.setState({selectedCountry:e})},t.prototype.acquirePhoneNumber=function(){var e=this,t=this.state.selectedCountry;fetch("/api/admin/numbers",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({code:t})}).then(function(t){if(!t.ok)throw new Error(t.statusText);console.log("Phone number configured"),e.setState({selectedCountry:void 0})}).catch(function(e){console.error(e)})},t.prototype.activateResetApplication=function(e){this.setState(e.target.checked?{resetApplicationActivated:!0}:{resetApplicationActivated:!1})},t.prototype.setupApplication=function(){fetch("/api/admin/setup",{method:"POST",credentials:"include"}).then(function(e){if(!e.ok)throw new Error(e.statusText);console.log("Project Setup")}).catch(function(e){console.error(e)})},t.prototype.componentDidMount=function(){this.getAvailableCountries()},t.prototype.render=function(){var e=this;return Object(m.h)("div",{class:Q.a.others},Z,Object(m.h)("div",{class:Q.a.cardContainer},Object(m.h)(p,{title:"Setup App",buttonText:"Setup",action:function(){return e.setupApplication()}},"This will create the necessary sync objects and other things necessary for the first setup."),$,X,Object(m.h)(p,{title:"Acquire New Phone Number",buttonText:"Acquire Number",action:function(){return e.acquirePhoneNumber()},disabled:!this.state.selectedCountry},U,void 0!==this.state.availableCountries?Object(m.h)(v,{countries:this.state.availableCountries,value:this.state.selectedCountry,onSelect:function(t){return e.choseCountry(t)}}):z),Object(m.h)(p,{title:"Reset Complete Application",buttonText:"Reset Entire Application",action:function(){return e.resetApplication()},disabled:!this.state.resetApplicationActivated},H,Object(m.h)(C.CheckBox,{name:"resetApplicationActivated",onChange:function(t){return e.activateResetApplication(t)},checked:this.state.resetApplicationActivated},"I know what I'm doing."))))},t}(m.Component),X=Object(m.h)(p,{title:"Reset Dashboard Stats",buttonText:"Reset Stats",disabled:!0},Object(m.h)("p",null,Object(m.h)("strong",null,"Important:")," Moved to the events section below the configuration"),Object(m.h)("p",null,"This will reset the statistics on the dashboard but maintains open orders and the customer database")),$=Object(m.h)(p,{title:"Cancel All Open Orders",buttonText:"Cancel All Open Orders",disabled:!0},Object(m.h)("p",null,"Empties all open orders and sends cancellation messages to everyone."),Object(m.h)("p",null,Object(m.h)("strong",null,"Important:")," This moved into the event view")),ee=n("PR/g"),te=n("Lpj9"),ne=void 0,oe=function(){function e(){b(this,e),this.globalConfig=void 0,this.globalConfigurationDoc=void 0,this.eventConfigurationDoc=void 0,this.eventConfig=void 0,this.eventId=void 0,this.client=void 0}return e.shared=function(){return ne=ne||new e},e.prototype.getConfig=function(){return this.globalConfig},e.prototype.init=function(e){return new Promise(function(t,n){return this.eventId=e,Promise.resolve(te.a.shared().init()).then(function(o){try{return this.client=o,Promise.resolve(this.client.document(j.SYNC_NAMES.CONFIGURATION)).then(function(o){try{return this.globalConfigurationDoc=o,this.globalConfig=this.globalConfigurationDoc.value,this.addGlobalEventListeners(),e?Promise.resolve(this.client.document(j.SYNC_NAMES.EVENT_CONFIG+e)).then(function(e){try{return this.eventConfigurationDoc=e,this.eventConfig=this.eventConfigurationDoc.value,this.addEventEventListeners(),t({eventConfig:this.eventConfig,config:this.globalConfig})}catch(e){return n(e)}}.bind(this),n):t({config:this.globalConfig})}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this),n)}.bind(this))},e.prototype.addGlobalEventListeners=function(){var e=this;this.globalConfigurationDoc.on("updated",function(t){e.globalConfig=t,e.emit("updatedGlobal",{config:t})}),this.globalConfigurationDoc.on("updatedRemotely",function(t){e.globalConfig=t,e.emit("updatedGlobal",{config:t})})},e.prototype.addEventEventListeners=function(){var e=this;this.eventConfigurationDoc.on("updated",function(t){e.eventConfig=t,e.emit("updatedEvent",{eventConfig:t})}),this.eventConfigurationDoc.on("updatedRemotely",function(t){e.eventConfig=t,e.emit("updatedEvent",{eventConfig:t})})},e.prototype.removeEventEventListeners=function(){this.eventConfigurationDoc.removeAllListeners("updated"),this.eventConfigurationDoc.removeAllListeners("updatedRemotely")},e.prototype.changeEvent=function(e){return new Promise(function(t,n){var o;return Promise.resolve(this.client.document(j.SYNC_NAMES.EVENT_CONFIG+e)).then(function(e){try{return o=e,this.eventConfigurationDoc=o,this.eventConfig=o.value,this.addEventEventListeners(),this.emit("updatedEvent",{eventConfig:this.eventConfig}),t({eventConfig:this.eventConfig})}catch(e){return n(e)}}.bind(this),n)}.bind(this))},e.prototype.updateValue=function(e,t,n){var o,r="event"===n?this.eventConfigurationDoc:this.globalConfigurationDoc;e&&r.update((o={},o[e]=t,o))},e}();ee(oe.prototype);var re=n("RS7i"),ie=n.n(re);n.d(t,"default",function(){return ge});var ae=Object(m.h)("p",null,"You are not admin"),ce=Object(m.h)(C.Tabs.Tab,{href:"#configuration",active:!0},"Configuration"),se=Object(m.h)(C.Tabs.Tab,{href:"#events"},"Events"),ue=Object(m.h)(C.Tabs.Tab,{href:"#messages"},"Messages"),le=Object(m.h)(C.Tabs.Tab,{href:"#other"},"Other"),he=Object(m.h)("h4",null,"Global Configuration"),de=Object(m.h)(C.Progress,{indeterminate:!0}),fe=Object(m.h)("h4",null,"Event Configuration"),pe=Object(m.h)(C.Tabs.TabPanel,{id:"messages"},Object(m.h)(Y,null)),ve=Object(m.h)(C.Tabs.TabPanel,{id:"other"},Object(m.h)(W,null)),be=Object(m.h)("h4",null,"Admin"),ge=function(e){function t(){g(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var i=y(this,e.call.apply(e,[this].concat(o)));return i.state.events=[],i.state.config=void 0,i.state.eventConfig=void 0,i.configService=oe.shared(),i.configService.on("updatedGlobal",function(e){i.setState({config:e.config})}),i.configService.on("updatedEvent",function(e){i.setState({eventConfig:e.eventConfig})}),i}return O(t,e),t.prototype.componentDidMount=function(){return new Promise(function(e,t){var n,o,r,i,a,c=function(){try{return e()}catch(e){return t(e)}}.bind(this),s=function(e){try{return console.log("Failed to initialize Admin"),console.error(e),c()}catch(e){return t(e)}}.bind(this);try{return Promise.resolve(fetch("/api/admin/events")).then(function(e){try{return Promise.resolve(e.json()).then(function(e){try{return n=e,o=n.events,this.eventId=o[0],Promise.resolve(this.configService.init(this.eventId)).then(function(e){try{return r=e,i=r.config,a=r.eventConfig,this.setState({events:o,config:i,eventConfig:a}),c()}catch(e){return s(e)}}.bind(this),s)}catch(e){return s(e)}}.bind(this),s)}catch(e){return s(e)}}.bind(this),s)}catch(e){s(e)}}.bind(this))},t.prototype.render=function(){var e=this,t=ae,n=Object(m.h)(C.Tabs,null,Object(m.h)(C.Tabs.TabBar,{class:ie.a.tabsLeft},ce,se,ue,le),Object(m.h)(C.Tabs.TabPanel,{id:"configuration",active:!0},he,this.state.config?Object(m.h)(w,{config:this.state.config,update:function(t,n){return e.updateConfig(t,n)}}):de),Object(m.h)(C.Tabs.TabPanel,{id:"events"},fe,Object(m.h)(J,{events:this.state.events,currentEventId:this.eventId,currentEventConfig:this.state.eventConfig,onEventChange:this.changeEvent.bind(this),onResetEvent:this.resetEventStats.bind(this),onDeleteEvent:this.deleteEvent.bind(this),onCreateEvent:this.createEvent.bind(this),onUpdateEventConfig:this.updateEventConfig.bind(this),onCancelOrders:this.cancelAllOpenOrders.bind(this)})),pe,ve);return Object(m.h)("div",{class:ie.a.admin},be,this.props.isAdmin?n:t)},t.prototype.renderEventsTab=function(){},t.prototype.updateConfig=function(e,t){this.configService.updateValue(e,t)},t.prototype.updateEventConfig=function(e,t){this.configService.updateValue(e,t,"event")},t.prototype.changeEvent=function(e){this.eventId=e,this.configService.changeEvent(this.eventId)},t.prototype.deleteEvent=function(){return new Promise(function(e,t){var n,o,r;n=this.eventId;var i=function(){try{return r=this.state.events.filter(function(e){return e!==n}),this.eventId=r[0],this.setState({events:r}),this.eventId?this.configService.changeEvent(this.eventId):this.setState({eventConfig:{}}),e()}catch(e){return t(e)}}.bind(this),a=function(){try{return console.error("Failed to make delete request"),e()}catch(e){return t(e)}}.bind(this);try{return Promise.resolve(fetch("/api/admin/events/"+n,{method:"DELETE",credentials:"include"})).then(function(t){try{return o=t,o.ok?i():(console.error("Failed to delete event"),e())}catch(e){return a(e)}}.bind(this),a)}catch(e){a(e)}}.bind(this))},t.prototype.resetEventStats=function(){return new Promise(function(e,t){var n,o;n=this.eventId;var r=function(){try{return e()}catch(e){return t(e)}}.bind(this),i=function(e){try{return console.error(e),r()}catch(e){return t(e)}}.bind(this);try{return Promise.resolve(fetch("/api/admin/reset?action=stats&eventId="+n,{method:"POST",credentials:"include"})).then(function(e){try{if(o=e,!o.ok)throw new Error(o.statusText);return console.log("Reset stats"),r()}catch(e){return i(e)}}.bind(this),i)}catch(e){i(e)}}.bind(this))},t.prototype.cancelAllOpenOrders=function(){return new Promise(function(e,t){var n,o=function(){try{return e()}catch(e){return t(e)}}.bind(this),r=function(e){try{return console.error(e),o()}catch(e){return t(e)}}.bind(this);try{return Promise.resolve(fetch("/api/admin/reset?action=openOrders&eventId="+this.eventId,{method:"POST",credentials:"include"})).then(function(e){try{if(n=e,!n.ok)throw new Error(n.statusText);return console.log("Cleared queue"),o()}catch(e){return r(e)}}.bind(this),r)}catch(e){r(e)}}.bind(this))},t.prototype.createEvent=function(e){return new Promise(function(t,n){var o,r,i=function(){try{return r=[].concat(this.state.events,[this.eventId]),this.setState({events:r}),this.configService.changeEvent(this.eventId),t()}catch(e){return n(e)}}.bind(this),a=function(e){try{return console.log("Failed to make create request"),console.error(e),t()}catch(e){return n(e)}}.bind(this);try{return Promise.resolve(fetch("/api/admin/events",{method:"POST",credentials:"include",body:JSON.stringify({eventName:e}),headers:{"Content-Type":"application/json"}})).then(function(e){try{return o=e,o.ok?Promise.resolve(o.json()).then(function(e){try{return this.eventId=e.eventId,i()}catch(e){return a(e)}}.bind(this),a):(console.error("Failed to create event"),t())}catch(e){return a(e)}}.bind(this),a)}catch(e){a(e)}}.bind(this))},t}(m.Component)}});
//# sourceMappingURL=route-admin.chunk.e1d7b.js.map